var Oe=Object.defineProperty,oe=Object.getOwnPropertySymbols,de=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable,pe=(m,v,i)=>v in m?Oe(m,v,{enumerable:!0,configurable:!0,writable:!0,value:i}):m[v]=i,ie=(m,v)=>{for(var i in v||(v={}))de.call(v,i)&&pe(m,i,v[i]);if(oe)for(var i of oe(v))fe.call(v,i)&&pe(m,i,v[i]);return m},ge=(m,v)=>{var i={};for(var f in m)de.call(m,f)&&v.indexOf(f)<0&&(i[f]=m[f]);if(null!=m&&oe)for(var f of oe(m))v.indexOf(f)<0&&fe.call(m,f)&&(i[f]=m[f]);return i};(self.webpackChunkclipit=self.webpackChunkclipit||[]).push([[982],{8292:(m,v,i)=>{i(5555);const{devDependencies:u}=i(3681);m.exports={corePath:`https://unpkg.com/@ffmpeg/core@${u["@ffmpeg/core"].substring(1)}/dist/ffmpeg-core.js`}},2187:(m,v,i)=>{var f=i(8926).default;const u=i(5555);m.exports=function(){var h=f(function*(g){let y=g;return void 0===g?new Uint8Array:("string"==typeof g?y=/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(g)?atob(g.split(",")[1]).split("").map(w=>w.charCodeAt(0)):yield(yield fetch(u(g))).arrayBuffer():(g instanceof File||g instanceof Blob)&&(y=yield(h=>new Promise((g,y)=>{const w=new FileReader;w.onload=()=>{g(w.result)},w.onerror=({target:{error:{code:x}}})=>{y(Error(`File could not be read! Code=${x}`))},w.readAsArrayBuffer(h)}))(g)),new Uint8Array(y))});return function(g){return h.apply(this,arguments)}}()},9965:(m,v,i)=>{var f=i(8926).default;const u=i(5555),{log:_}=i(6945),h=function(){var g=f(function*(y,w){_("info",`fetch ${y}`);const x=yield(yield fetch(y)).arrayBuffer();_("info",`${y} file size = ${x.byteLength} bytes`);const e=new Blob([x],{type:w}),U=URL.createObjectURL(e);return _("info",`${y} blob URL = ${U}`),U});return function(w,x){return g.apply(this,arguments)}}();m.exports=function(){var g=f(function*({corePath:y}){if("string"!=typeof y)throw Error("corePath should be a string!");const w=u(y),x=yield h(w,"application/javascript"),e=yield h(w.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),U=yield h(w.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return"undefined"==typeof createFFmpegCore?new Promise(M=>{const Z=document.createElement("script"),I=()=>{Z.removeEventListener("load",I),_("info","ffmpeg-core.js script loaded"),M({createFFmpegCore,corePath:x,wasmPath:e,workerPath:U})};Z.src=x,Z.type="text/javascript",Z.addEventListener("load",I),document.getElementsByTagName("head")[0].appendChild(Z)}):(_("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore,corePath:x,wasmPath:e,workerPath:U}))});return function(y){return g.apply(this,arguments)}}()},1346:(m,v,i)=>{const f=i(8292),u=i(9965),_=i(2187);m.exports={defaultOptions:f,getCreateFFmpegCore:u,fetchFile:_}},6151:m=>{m.exports={defaultArgs:["./ffmpeg","-nostdin","-y"],baseOptions:{log:!1,logger:()=>{},progress:()=>{},corePath:""}}},9639:(m,v,i)=>{var f=i(8926).default;const{defaultArgs:u,baseOptions:_}=i(6151),{setLogging:h,setCustomLogger:g,log:y}=i(6945),w=i(5542),x=i(8333),{defaultOptions:e,getCreateFFmpegCore:U}=i(1346),{version:M}=i(3681),Z=Error("ffmpeg.wasm is not ready, make sure you have completed load().");m.exports=(I={})=>{const s=ie(ie(ie({},_),e),I),{log:J,logger:$,progress:H}=s,G=ge(s,["log","logger","progress"]);let F=null,C=null,O=null,D=!1,N=H;const j=({type:n,message:a})=>{y(n,a),w(a,N),(n=>{"FFMPEG_END"===n&&null!==O&&(O(),O=null,D=!1)})(a)},ee=function(){var n=f(function*(){if(y("info","load ffmpeg-core"),null!==F)throw Error("ffmpeg.wasm was loaded, you should not load it again, use ffmpeg.isLoaded() to check next time.");{y("info","loading ffmpeg-core");const{createFFmpegCore:a,corePath:p,workerPath:d,wasmPath:S}=yield U(G);F=yield a({mainScriptUrlOrBlob:p,printErr:T=>j({type:"fferr",message:T}),print:T=>j({type:"ffout",message:T}),locateFile:(T,L)=>{if("undefined"!=typeof window){if(void 0!==S&&T.endsWith("ffmpeg-core.wasm"))return S;if(void 0!==d&&T.endsWith("ffmpeg-core.worker.js"))return d}return L+T}}),C=F.cwrap("proxy_main","number",["number","number"]),y("info","ffmpeg-core loaded")}});return function(){return n.apply(this,arguments)}}();return h(J),g($),y("info",`use ffmpeg.wasm v${M}`),{setProgress:n=>{N=n},setLogger:n=>{g(n)},setLogging:h,load:ee,isLoaded:()=>null!==F,run:(...n)=>{if(y("info",`run ffmpeg command: ${n.join(" ")}`),null===F)throw Z;if(D)throw Error("ffmpeg.wasm can only run one command at a time");return D=!0,new Promise(a=>{const p=[...u,...n].filter(d=>0!==d.length);O=a,C(...x(F,p))})},exit:()=>{if(null===F)throw Z;D=!1,F.exit(1),F=null,C=null,O=null},FS:(n,...a)=>{if(y("info",`run FS.${n} ${a.map(p=>"string"==typeof p?p:`<${p.length} bytes binary file>`).join(" ")}`),null===F)throw Z;{let p=null;try{p=F.FS[n](...a)}catch(d){throw Error("readdir"===n?`ffmpeg.FS('readdir', '${a[0]}') error. Check if the path exists, ex: ffmpeg.FS('readdir', '/')`:"readFile"===n?`ffmpeg.FS('readFile', '${a[0]}') error. Check if the path exists`:"Oops, something went wrong in FS operation.")}return p}}}}},260:(m,v,i)=>{i(7854);const f=i(9639),{fetchFile:u}=i(1346);m.exports={createFFmpeg:f,fetchFile:u}},6945:m=>{let v=!1,i=()=>{};m.exports={logging:v,setLogging:h=>{v=h},setCustomLogger:h=>{i=h},log:(h,g)=>{i({type:h,message:g}),v&&console.log(`[${h}] ${g}`)}}},8333:m=>{m.exports=(v,i)=>{const f=v._malloc(i.length*Uint32Array.BYTES_PER_ELEMENT);return i.forEach((u,_)=>{const h=v._malloc(u.length+1);v.writeAsciiToMemory(u,h),v.setValue(f+Uint32Array.BYTES_PER_ELEMENT*_,h,"i32")}),[i.length,f]}},5542:m=>{let v=0,i=0;const f=u=>{const[_,h,g]=u.split(":");return 60*parseFloat(_)*60+60*parseFloat(h)+parseFloat(g)};m.exports=(u,_)=>{if("string"==typeof u)if(u.startsWith("  Duration")){const h=u.split(", ")[0].split(": ")[1],g=f(h);_({duration:g,ratio:i}),(0===v||v>g)&&(v=g)}else if(u.startsWith("frame")||u.startsWith("size")){const h=u.split("time=")[1].split(" ")[0],g=f(h);i=g/v,_({ratio:i,time:g})}else u.startsWith("video:")&&(_({ratio:1}),v=0)}},6982:(m,v,i)=>{"use strict";i.r(v),i.d(v,{VideoModule:()=>Ze});var I,f=i(9808),u=i(3075),_=i(4466),h=i(9100),g=i(1135),y=i(7579),w=i(9841),x=i(4004),e=i(5e3),U=i(3900),M=i(9646),Z=i(4128),J=new Uint8Array(16);function $(){if(!I&&!(I="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return I(J)}const H=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,F=function G(r){return"string"==typeof r&&H.test(r)};for(var C=[],O=0;O<256;++O)C.push((O+256).toString(16).substr(1));const j=function z(r,c,t){var o=(r=r||{}).random||(r.rng||$)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,c){t=t||0;for(var l=0;l<16;++l)c[t+l]=o[l];return c}return function D(r){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(C[r[c+0]]+C[r[c+1]]+C[r[c+2]]+C[r[c+3]]+"-"+C[r[c+4]]+C[r[c+5]]+"-"+C[r[c+6]]+C[r[c+7]]+"-"+C[r[c+8]]+C[r[c+9]]+"-"+C[r[c+10]]+C[r[c+11]]+C[r[c+12]]+C[r[c+13]]+C[r[c+14]]+C[r[c+15]]).toLowerCase();if(!F(t))throw TypeError("Stringified UUID is invalid");return t}(o)};var ee=i(7566),X=i(1205),te=i(2084),R=i(5861),Y=i(260);let Q=(()=>{class r{constructor(){this._isReadyBehaviourSubject=new g.X(!1),this.isReady$=this._isReadyBehaviourSubject.asObservable(),this._ffmpeg=(0,Y.createFFmpeg)({log:!0})}init(){var t=this;return(0,R.Z)(function*(){t._isReadyBehaviourSubject.getValue()||(yield t._ffmpeg.load(),t._isReadyBehaviourSubject.next(!0))})()}getScreenShots(t){var o=this;return(0,R.Z)(function*(){const l=yield(0,Y.fetchFile)(t);o._ffmpeg.FS("writeFile",t.name,l);const b=[1,2,3],P=[];b.forEach(k=>{P.push("-i",t.name,"-ss",`00:00:0${k}`,"-frames:v","1","-filter:v","scale=510:-1",`output_0${k}.png`)}),yield o._ffmpeg.run(...P);const W=[];return b.forEach(k=>{const K=o._ffmpeg.FS("readFile",`output_0${k}.png`),ne=new Blob([K.buffer],{type:"image/png"}),se=URL.createObjectURL(ne);W.push(se)}),W})()}blobFromURL(t){return(0,R.Z)(function*(){return yield(yield fetch(t)).blob()})()}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),V=(()=>{class r{constructor(t,o,l,b){this.angularFirestore=t,this.angularFireAuth=o,this.angularFireStorage=l,this.ffmpegService=b,this.CLIPS_COLLECTION_ID="clips",this._clipsCollection=this.angularFirestore.collection(this.CLIPS_COLLECTION_ID)}createClip(t){return this._clipsCollection.add(t)}uploadClip(t){const l=`clips/${j()}.mp4`;return[this.angularFireStorage.upload(l,t),this.angularFireStorage.ref(l)]}uploadScreenshot(t){const l=`screenshots/${j()}.png`;return[this.angularFireStorage.upload(l,t),this.angularFireStorage.ref(l)]}updateClip(t){return this._clipsCollection.doc(t.docID).update(t)}getUserClips(){return this.angularFireAuth.user.pipe((0,U.w)(t=>t?this._clipsCollection.ref.where("uid","==",t.uid).get():(0,M.of)(null)),(0,x.U)(t=>{var o;return null!==(o=null==t?void 0:t.docs)&&void 0!==o?o:null}))}deleteClip(t){const o=this.angularFireStorage.ref(`clips/${t.fileName}`),l=this.angularFireStorage.ref(`screenshots/${t.screenshotFileName}`);return(0,Z.D)([o.delete(),l.delete(),this._clipsCollection.doc(t.docID).delete()]).pipe((0,x.U)(()=>t.docID))}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(ee.ST),e.LFG(X.zQ),e.LFG(te.Q1),e.LFG(Q))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var s=i(1609),n=i(276),a=i(8549),p=i(235);function d(r,c){if(1&r&&(e.TgZ(0,"app-alert",9)(1,"p"),e._uU(2),e.qZA()()),2&r){const t=e.oxw().$implicit;e.Q6J("color",t.color),e.xp6(2),e.Oqu(t.msg)}}function S(r,c){if(1&r&&(e.ynx(0),e.YNc(1,d,3,2,"app-alert",8),e.BQk()),2&r){const t=c.$implicit;e.xp6(1),e.Q6J("ngIf",t.show)}}const T=function(r,c){return{"opacity-50":r,"hover:bg-indigo-700":c}};let L=(()=>{class r{constructor(t){this.clipService=t,this._clip=null,this.update=new e.vpe,this.alert$=new y.x,this.isProcessingRequest$=new y.x,this.clipId=new u.NI("",[u.kI.required]),this.title=new u.NI("",[u.kI.required,u.kI.minLength(3)]),this.editForm=new u.cw({title:this.title,id:this.clipId})}set clip(t){console.log("Nam data is: setting new clip",t),this._clip=t,this.clip&&(this.clipId.setValue(this.clip.docID),this.title.setValue(this.clip.title),this.alert$.next(null))}get clip(){return this._clip}onEditFormSubmit(){var t=this;return(0,R.Z)(function*(){if(t.clip){t.isProcessingRequest$.next(!0),t.alert$.next({show:!0,msg:"Please wait while we're updating your clip",color:"blue"});try{yield t.clipService.updateClip({docID:t.clipId.value,title:t.title.value})}catch(o){return t.isProcessingRequest$.next(!1),void t.alert$.next({show:!0,color:"red",msg:"Something went wrong. Please try again later"})}t.clip.title=t.title.value,t.update.emit(t.clip),t.isProcessingRequest$.next(!1),t.alert$.next({show:!0,color:"green",msg:"Success! Your clip is now updated"})}})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(V))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-edit"]],inputs:{clip:"clip"},outputs:{update:"update"},decls:15,vars:16,consts:[[1,"text-2xl","font-bold"],[4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"mt-4"],[1,"block","text-xl","mb-4"],["placeHolder","Enter title",3,"control"],[1,"mt-4","text-right"],["type","submit",1,"inline-flex","justify-center","py-2","px-4","border","border-transparent","shadow-sm","rounded-md","text-white","bg-indigo-600","focus:outline-none",3,"disabled","ngClass"],[3,"color",4,"ngIf"],[3,"color"]],template:function(t,o){1&t&&(e.TgZ(0,"p",0),e._uU(1,"Edit Video"),e.qZA(),e.YNc(2,S,2,1,"ng-container",1),e.ALo(3,"async"),e.TgZ(4,"form",2),e.NdJ("ngSubmit",function(){return o.onEditFormSubmit()}),e.TgZ(5,"div",3)(6,"label",4),e._uU(7,"Title"),e.qZA(),e._UZ(8,"app-input",5),e.qZA(),e.TgZ(9,"div",6)(10,"button",7),e.ALo(11,"async"),e.ALo(12,"async"),e.ALo(13,"async"),e._uU(14," Update "),e.qZA()()()),2&t&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,5,o.alert$)),e.xp6(2),e.Q6J("formGroup",o.editForm),e.xp6(4),e.Q6J("control",o.title),e.xp6(2),e.Q6J("disabled",e.lcZ(11,7,o.isProcessingRequest$))("ngClass",e.WLB(13,T,e.lcZ(12,9,o.isProcessingRequest$),!1===e.lcZ(13,11,o.isProcessingRequest$))))},directives:[f.O5,a.w,u._Y,u.JL,u.sg,p.a,f.mk],pipes:[f.Ov],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),r})();function A(r,c){if(1&r){const t=e.EpF();e.TgZ(0,"div",11)(1,"a",12),e._UZ(2,"img",13),e.qZA(),e.TgZ(3,"div",14)(4,"a",15),e._uU(5),e.qZA(),e.TgZ(6,"a",16),e._uU(7," Copy Link "),e.qZA()(),e.TgZ(8,"div",17)(9,"a",18),e.NdJ("click",function(l){const P=e.CHM(t).$implicit;return e.oxw().onEditLinkClick(l,P)}),e.TgZ(10,"span",19),e._uU(11,"build"),e.qZA()(),e.TgZ(12,"a",20),e.NdJ("click",function(l){const P=e.CHM(t).$implicit;return e.oxw().onDeleteLinkClick(l,P)}),e.TgZ(13,"span",19),e._uU(14,"delete"),e.qZA()()()()}if(2&r){const t=c.$implicit;e.xp6(5),e.hij(" ",t.title," ")}}let E=(()=>{class r{constructor(t,o,l,b){this.router=t,this.activatedRouter=o,this.clipService=l,this.modalService=b,this.EDIT_MODAL_ID="editModal",this.videosSortOrder="asc",this.clips$=new g.X([]),this.activeClip$=new y.x}ngOnInit(){(0,w.a)([this.activatedRouter.queryParamMap,this.clipService.getUserClips().pipe((0,x.U)(t=>{var o;return null!==(o=null==t?void 0:t.map(l=>Object.assign(Object.assign({},l.data()),{docID:l.id})))&&void 0!==o?o:null}))]).subscribe(([t,o])=>{const l=t.get("sort");l&&("asc"===l||"desc"===l)&&(this.videosSortOrder=l),o&&(o.sort((b,P)=>"desc"===this.videosSortOrder?b.timestamp.seconds-P.timestamp.seconds:P.timestamp.seconds-b.timestamp.seconds),this.clips$.next(null!=o?o:[]))})}sort(t){const{value:o}=t.target;this.router.navigate([],{relativeTo:this.activatedRouter,queryParams:{sort:o}})}onEditLinkClick(t,o){t.preventDefault(),this.activeClip$.next(Object.assign({},o)),this.modalService.showModal(this.EDIT_MODAL_ID)}onDeleteLinkClick(t,o){t.preventDefault(),this.clipService.deleteClip(o).subscribe({next:()=>{const l=this.clips$.getValue().filter(b=>b.docID!==o.docID);this.clips$.next(l)}})}onClipUpdate(t){const o=this.clips$.getValue(),l=o.findIndex(b=>b.docID===t.docID);o[l]=Object.assign(Object.assign({},o[l]),t),this.clips$.next(o)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(h.F0),e.Y36(h.gz),e.Y36(V),e.Y36(s.Z))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-manage"]],decls:16,vars:9,consts:[[1,"container","mx-auto","my-8","bg-secondary","p-6"],[1,"rounded","relative","flex","justify-between"],["routerLink","/video/upload",1,"bg-indigo-400","text-white","py-4","px-10","text-xl"],[1,"text-black","px-8","text-xl","outline-none","appearance-none",3,"change"],["value","asc",3,"selected"],["value","desc",3,"selected"],[1,"container","mx-auto","my-8"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-4"],["class","mt-6 rounded-tl-2xl rounded-br-2xl shadow-xl bg-secondary flex flex-col justify-start",4,"ngFor","ngForOf"],[3,"id"],[3,"clip","update"],[1,"mt-6","rounded-tl-2xl","rounded-br-2xl","shadow-xl","bg-secondary","flex","flex-col","justify-start"],["href","#"],["src","assets/img/1.jpg",1,"card-img-top","rounded-tl-2xl","w-full"],[1,"p-6","text-2xl"],["href","#",1,"font-bold","mb-2"],["href","#",1,"bg-gray-400","text-white","px-2","py-1","ml-2","text-sm","rounded"],[1,"flex","text-center","text-2xl","bg-gray-800","p-2","mt-auto"],["href","#",1,"flex-1","p-2","border-right","border-r-2","border-gray-700","transition","hover:text-indigo-400",3,"click"],[1,"material-icons","text-base"],["href","#",1,"flex-1","p-2","rounded-br-2xl","transition","hover:text-indigo-400",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"a",2),e._uU(3,"Upload Videos"),e.qZA(),e.TgZ(4,"select",3),e.NdJ("change",function(b){return o.sort(b)}),e.TgZ(5,"option",4),e._uU(6," Recent Uploads "),e.qZA(),e.TgZ(7,"option",5),e._uU(8," Oldest Uploads "),e.qZA()()()(),e.TgZ(9,"div",6)(10,"div",7),e.YNc(11,A,15,1,"div",8),e.ALo(12,"async"),e.qZA()(),e.TgZ(13,"app-modal",9)(14,"app-edit",10),e.NdJ("update",function(b){return o.onClipUpdate(b)}),e.ALo(15,"async"),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("selected","asc"===o.videosSortOrder),e.xp6(2),e.Q6J("selected","desc"===o.videosSortOrder),e.xp6(4),e.Q6J("ngForOf",e.lcZ(12,5,o.clips$)),e.xp6(2),e.Q6J("id",o.EDIT_MODAL_ID),e.xp6(1),e.Q6J("clip",e.lcZ(15,7,o.activeClip$)))},directives:[h.yS,u.YN,u.Kr,f.sg,n.z,L],pipes:[f.Ov],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),r})();var re=i(127),q=i(7556);let B=(()=>{class r{handleEvent(t){t.preventDefault()}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275dir=e.lG2({type:r,selectors:[["","appEventBlocker",""]],hostBindings:function(t,o){1&t&&e.NdJ("drop",function(b){return o.handleEvent(b)})("dragover",function(b){return o.handleEvent(b)})}}),r})();var me=i(2313);let he=(()=>{class r{constructor(t){this.domSanitizer=t}transform(t){return this.domSanitizer.bypassSecurityTrustUrl(t)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(me.H7,16))},r.\u0275pipe=e.Yjl({name:"safeURL",type:r,pure:!0}),r})();const ve=function(r){return{"bg-indigo-400 border-indigo-400 border-solid":r}};function ye(r,c){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",6),e.NdJ("dragend",function(){return e.CHM(t),e.oxw(2).isDragOver=!1})("dragover",function(){return e.CHM(t),e.oxw(2).isDragOver=!0})("dragenter",function(){return e.CHM(t),e.oxw(2).isDragOver=!0})("dragleave",function(){return e.CHM(t),e.oxw(2).isDragOver=!1})("mouseleave",function(){return e.CHM(t),e.oxw(2).isDragOver=!1})("drop",function(l){return e.CHM(t),e.oxw(2).onFileDrop(l)}),e.TgZ(2,"h5"),e._uU(3,"Drop your file here (mp4 only!)"),e.qZA()(),e.TgZ(4,"input",7),e.NdJ("change",function(l){return e.CHM(t),e.oxw(2).onFileSelect(l)}),e.qZA(),e.BQk()}if(2&r){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(1,ve,t.isDragOver))}}function _e(r,c){if(1&r&&(e.ynx(0),e.YNc(1,ye,5,3,"ng-container",3),e.ALo(2,"async"),e.ALo(3,"async"),e.BQk()),2&r){const t=e.oxw(),o=e.MAs(8);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,t.ffmpegSevice.isReady$)&&!0!==e.lcZ(3,4,t.isProcessingVideo$))("ngIfElse",o)}}function xe(r,c){if(1&r&&(e.TgZ(0,"p"),e._uU(1),e.ALo(2,"percent"),e.qZA()),2&r){const t=c.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t)," ")}}function be(r,c){if(1&r&&(e.TgZ(0,"app-alert",19)(1,"p"),e._uU(2),e.qZA(),e.YNc(3,xe,3,3,"p",8),e.ALo(4,"async"),e.qZA()),2&r){const t=e.oxw().$implicit,o=e.oxw(2);e.Q6J("color",t.color),e.xp6(2),e.Oqu(t.msg),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,3,o.uploadPercentage$))}}function we(r,c){if(1&r&&(e.ynx(0),e.YNc(1,be,5,5,"app-alert",18),e.BQk()),2&r){const t=c.$implicit;e.xp6(1),e.Q6J("ngIf",t.show)}}const Ce=function(r,c){return{"border-green-400":r,"border-transparent":c}};function Se(r,c){if(1&r){const t=e.EpF();e.TgZ(0,"div",20),e.NdJ("click",function(){const b=e.CHM(t).$implicit;return e.oxw(2).selectedScreenshot$.next(b)}),e.ALo(1,"async"),e.ALo(2,"async"),e._UZ(3,"img",21),e.ALo(4,"safeURL"),e.qZA()}if(2&r){const t=c.$implicit,o=e.oxw(2);e.Q6J("ngClass",e.WLB(8,Ce,t===e.lcZ(1,2,o.selectedScreenshot$),t!==e.lcZ(2,4,o.selectedScreenshot$))),e.xp6(3),e.Q6J("src",e.lcZ(4,6,t),e.LSH)}}const Te=function(r,c){return{"opacity-50":r,"hover:bg-indigo-700":c}};function Fe(r,c){if(1&r){const t=e.EpF();e.YNc(0,we,2,1,"ng-container",8),e.ALo(1,"async"),e.TgZ(2,"form",9),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw().uploadFile()}),e.TgZ(3,"h2",10),e._uU(4,"Select a Thumbnail"),e.qZA(),e.TgZ(5,"div",11),e.YNc(6,Se,5,11,"div",12),e.ALo(7,"async"),e.qZA(),e.TgZ(8,"div",13)(9,"label",14),e._uU(10,"Title"),e.qZA(),e._UZ(11,"app-input",15),e.qZA(),e.TgZ(12,"div",16)(13,"button",17),e.ALo(14,"async"),e.ALo(15,"async"),e.ALo(16,"async"),e._uU(17," Publish "),e.qZA()()()}if(2&r){const t=e.oxw();e.Q6J("ngIf",e.lcZ(1,6,t.alert$)),e.xp6(2),e.Q6J("formGroup",t.uploadForm),e.xp6(4),e.Q6J("ngForOf",e.lcZ(7,8,t.screenshots$)),e.xp6(5),e.Q6J("control",t.title),e.xp6(2),e.Q6J("disabled",e.lcZ(14,10,t.isProcessingRequest$))("ngClass",e.WLB(16,Te,e.lcZ(15,12,t.isProcessingRequest$),!1===e.lcZ(16,14,t.isProcessingRequest$)))}}function Le(r,c){1&r&&(e.TgZ(0,"span",22),e._uU(1," settings "),e.qZA())}const Ue=[{path:"manage",component:E},{path:"upload",component:(()=>{class r{constructor(t,o,l,b){this.authService=t,this.clipService=o,this.router=l,this.ffmpegSevice=b,this.CLIP_UPLOADING_MESSAGE="Please wait! Your clip is being uploaded",this.isDragOver=!1,this.file=null,this.user=null,this.screenshots$=(0,M.of)([]),this.isProcessingVideo$=new y.x,this.selectedScreenshot$=new g.X(null),this.alert$=new y.x,this.formEnabled=!1,this.title=new u.NI("",[u.kI.required,u.kI.minLength(3)]),this.uploadForm=new u.cw({title:this.title}),this.isProcessingRequest$=new y.x,this.uploadPercentage$=new y.x,this.videoUploadTask=null,this.screenshotUploadTask=null,this.authService.user$.subscribe(P=>this.user=P),this.ffmpegSevice.init()}ngOnDestroy(){this.videoUploadTask&&this.videoUploadTask.cancel(),this.screenshotUploadTask&&this.screenshotUploadTask.cancel()}onFileDrop(t){var o,l;this.isDragOver=!1;const b=null!==(l=null===(o=t.dataTransfer)||void 0===o?void 0:o.files[0])&&void 0!==l?l:null;this.setFile(b)}onFileSelect(t){var o,l;const b=null!==(l=null===(o=t.target.files)||void 0===o?void 0:o[0])&&void 0!==l?l:null;this.setFile(b)}setFile(t){var o=this;return(0,R.Z)(function*(){var l;if(!t)return;if(o.file=t,"video/mp4"!==o.file.type)return void console.log("Nam data is: ",null===(l=o.file)||void 0===l?void 0:l.type);o.isProcessingVideo$.next(!0);const b=yield o.ffmpegSevice.getScreenShots(o.file);o.screenshots$=(0,M.of)(b),o.selectedScreenshot$.next(b[0]),o.isProcessingVideo$.next(!0),o.title.setValue(o.file.name.replace(/\.[^/.]+$/,"")),o.formEnabled=!0})()}uploadFile(){var t=this;return(0,R.Z)(function*(){if(!t.file)return;t.uploadForm.disable(),t.alert$.next({show:!0,color:"blue",msg:t.CLIP_UPLOADING_MESSAGE}),t.isProcessingRequest$.next(!0);const o=yield t.ffmpegSevice.blobFromURL(t.selectedScreenshot$.getValue()),[l,b]=t.clipService.uploadClip(t.file);t.videoUploadTask=l;const[P,W]=t.clipService.uploadScreenshot(o);var k;t.screenshotUploadTask=P,(0,w.a)([t.videoUploadTask.percentageChanges(),t.screenshotUploadTask.percentageChanges()]).pipe((0,x.U)(([k,K])=>((k||0)+(K||0))/200)).subscribe(k=>t.uploadPercentage$.next(k)),(0,Z.D)([t.videoUploadTask.snapshotChanges(),t.screenshotUploadTask.snapshotChanges()]).pipe((0,U.w)(()=>(0,Z.D)([b.getDownloadURL(),b.getMetadata(),W.getDownloadURL(),W.getMetadata()]))).subscribe({next:(k=(0,R.Z)(function*([K,ne,se,$e]){var ae,le,ce,ue;t.isProcessingRequest$.next(!1);const Ae={uid:null!==(le=null===(ae=t.user)||void 0===ae?void 0:ae.uuid)&&void 0!==le?le:"unknow",displayName:null!==(ue=null===(ce=t.user)||void 0===ce?void 0:ce.name)&&void 0!==ue?ue:"unknow user displayName",title:t.title.value,fileName:ne.name,url:K,screenshotURL:se,screenshotFileName:$e.name,timestamp:re.Z.firestore.FieldValue.serverTimestamp()},Pe=yield t.clipService.createClip(Ae);setTimeout(()=>{t.router.navigate(["clips",Pe.id])},1e3),t.alert$.next({color:"green",msg:"Success! Your clip is now ready to be shared with the world.",show:!0})}),function(ne){return k.apply(this,arguments)}),error:k=>{t.isProcessingRequest$.next(!1),t.uploadForm.enable(),t.alert$.next({color:"red",msg:"Upload failed. Please try again later",show:!0}),console.log("Nam data is: ",k)}})})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(q.e),e.Y36(V),e.Y36(h.F0),e.Y36(Q))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-upload"]],decls:9,vars:2,consts:[[1,"container","mx-auto","my-8","bg-secondary","p-6"],[1,"rounded","relative","flex","flex-col"],[1,"font-bold","mb-6"],[4,"ngIf","ngIfElse"],["uploadFormTpl",""],["loadingTpl",""],["appEventBlocker","",1,"w-full","px-10","py-40","rounded","text-center","cursor-pointer","border","border-dashed","border-gray-400","transition","duration-500","hover:text-white","hover:bg-indigo-400","hover:border-indigo-400","hover:border-solid","text-xl",3,"ngClass","dragend","dragover","dragenter","dragleave","mouseleave","drop"],["type","file",1,"mt-4",3,"change"],[4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"mb-4","text-xl"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-4"],["class","border-8 cursor-pointer",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"mt-4"],[1,"block","text-xl","mb-4"],["placeHolder","Enter title",3,"control"],[1,"mt-4","text-right"],["type","submit",1,"inline-flex","justify-center","py-2","px-4","border","border-transparent","shadow-sm","rounded-md","text-white","bg-indigo-600","focus:outline-none",3,"disabled","ngClass"],[3,"color",4,"ngIf"],[3,"color"],[1,"border-8","cursor-pointer",3,"ngClass","click"],[3,"src"],[1,"material-symbols-outlined","text-center","text-6xl","p-8","animate-spin"]],template:function(t,o){if(1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e._uU(3,"Upload Video"),e.qZA(),e.YNc(4,_e,4,6,"ng-container",3),e.YNc(5,Fe,18,19,"ng-template",null,4,e.W1O),e.qZA()(),e.YNc(7,Le,2,0,"ng-template",null,5,e.W1O)),2&t){const l=e.MAs(6);e.xp6(4),e.Q6J("ngIf",!o.formEnabled)("ngIfElse",l)}},directives:[f.O5,B,f.mk,a.w,u._Y,u.JL,u.sg,f.sg,p.a],pipes:[f.Ov,f.Zx,he],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),r})()},{path:"manage-clips",redirectTo:"manage"}];let Ee=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[h.Bz.forChild(Ue)],h.Bz]}),r})(),Ze=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[f.ez,Ee,_.m,u.UX]]}),r})()},7854:m=>{var v=function(i){"use strict";var _,f=Object.prototype,u=f.hasOwnProperty,h="function"==typeof Symbol?Symbol:{},g=h.iterator||"@@iterator",y=h.asyncIterator||"@@asyncIterator",w=h.toStringTag||"@@toStringTag";function x(s,n,a){return Object.defineProperty(s,n,{value:a,enumerable:!0,configurable:!0,writable:!0}),s[n]}try{x({},"")}catch(s){x=function(n,a,p){return n[a]=p}}function e(s,n,a,p){var S=Object.create((n&&n.prototype instanceof H?n:H).prototype),T=new Y(p||[]);return S._invoke=function ee(s,n,a){var p=M;return function(S,T){if(p===I)throw new Error("Generator is already running");if(p===J){if("throw"===S)throw T;return V()}for(a.method=S,a.arg=T;;){var L=a.delegate;if(L){var A=X(L,a);if(A){if(A===$)continue;return A}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(p===M)throw p=J,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);p=I;var E=U(s,n,a);if("normal"===E.type){if(p=a.done?J:Z,E.arg===$)continue;return{value:E.arg,done:a.done}}"throw"===E.type&&(p=J,a.method="throw",a.arg=E.arg)}}}(s,a,T),S}function U(s,n,a){try{return{type:"normal",arg:s.call(n,a)}}catch(p){return{type:"throw",arg:p}}}i.wrap=e;var M="suspendedStart",Z="suspendedYield",I="executing",J="completed",$={};function H(){}function G(){}function F(){}var C={};x(C,g,function(){return this});var O=Object.getPrototypeOf,D=O&&O(O(Q([])));D&&D!==f&&u.call(D,g)&&(C=D);var N=F.prototype=H.prototype=Object.create(C);function z(s){["next","throw","return"].forEach(function(n){x(s,n,function(a){return this._invoke(n,a)})})}function j(s,n){function a(S,T,L,A){var E=U(s[S],s,T);if("throw"!==E.type){var re=E.arg,q=re.value;return q&&"object"==typeof q&&u.call(q,"__await")?n.resolve(q.__await).then(function(B){a("next",B,L,A)},function(B){a("throw",B,L,A)}):n.resolve(q).then(function(B){re.value=B,L(re)},function(B){return a("throw",B,L,A)})}A(E.arg)}var p;this._invoke=function d(S,T){function L(){return new n(function(A,E){a(S,T,A,E)})}return p=p?p.then(L,L):L()}}function X(s,n){var a=s.iterator[n.method];if(a===_){if(n.delegate=null,"throw"===n.method){if(s.iterator.return&&(n.method="return",n.arg=_,X(s,n),"throw"===n.method))return $;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return $}var p=U(a,s.iterator,n.arg);if("throw"===p.type)return n.method="throw",n.arg=p.arg,n.delegate=null,$;var d=p.arg;return d?d.done?(n[s.resultName]=d.value,n.next=s.nextLoc,"return"!==n.method&&(n.method="next",n.arg=_),n.delegate=null,$):d:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,$)}function te(s){var n={tryLoc:s[0]};1 in s&&(n.catchLoc=s[1]),2 in s&&(n.finallyLoc=s[2],n.afterLoc=s[3]),this.tryEntries.push(n)}function R(s){var n=s.completion||{};n.type="normal",delete n.arg,s.completion=n}function Y(s){this.tryEntries=[{tryLoc:"root"}],s.forEach(te,this),this.reset(!0)}function Q(s){if(s){var n=s[g];if(n)return n.call(s);if("function"==typeof s.next)return s;if(!isNaN(s.length)){var a=-1,p=function d(){for(;++a<s.length;)if(u.call(s,a))return d.value=s[a],d.done=!1,d;return d.value=_,d.done=!0,d};return p.next=p}}return{next:V}}function V(){return{value:_,done:!0}}return G.prototype=F,x(N,"constructor",F),x(F,"constructor",G),G.displayName=x(F,w,"GeneratorFunction"),i.isGeneratorFunction=function(s){var n="function"==typeof s&&s.constructor;return!!n&&(n===G||"GeneratorFunction"===(n.displayName||n.name))},i.mark=function(s){return Object.setPrototypeOf?Object.setPrototypeOf(s,F):(s.__proto__=F,x(s,w,"GeneratorFunction")),s.prototype=Object.create(N),s},i.awrap=function(s){return{__await:s}},z(j.prototype),x(j.prototype,y,function(){return this}),i.AsyncIterator=j,i.async=function(s,n,a,p,d){void 0===d&&(d=Promise);var S=new j(e(s,n,a,p),d);return i.isGeneratorFunction(n)?S:S.next().then(function(T){return T.done?T.value:S.next()})},z(N),x(N,w,"Generator"),x(N,g,function(){return this}),x(N,"toString",function(){return"[object Generator]"}),i.keys=function(s){var n=[];for(var a in s)n.push(a);return n.reverse(),function p(){for(;n.length;){var d=n.pop();if(d in s)return p.value=d,p.done=!1,p}return p.done=!0,p}},i.values=Q,Y.prototype={constructor:Y,reset:function(s){if(this.prev=0,this.next=0,this.sent=this._sent=_,this.done=!1,this.delegate=null,this.method="next",this.arg=_,this.tryEntries.forEach(R),!s)for(var n in this)"t"===n.charAt(0)&&u.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=_)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(s){if(this.done)throw s;var n=this;function a(A,E){return S.type="throw",S.arg=s,n.next=A,E&&(n.method="next",n.arg=_),!!E}for(var p=this.tryEntries.length-1;p>=0;--p){var d=this.tryEntries[p],S=d.completion;if("root"===d.tryLoc)return a("end");if(d.tryLoc<=this.prev){var T=u.call(d,"catchLoc"),L=u.call(d,"finallyLoc");if(T&&L){if(this.prev<d.catchLoc)return a(d.catchLoc,!0);if(this.prev<d.finallyLoc)return a(d.finallyLoc)}else if(T){if(this.prev<d.catchLoc)return a(d.catchLoc,!0)}else{if(!L)throw new Error("try statement without catch or finally");if(this.prev<d.finallyLoc)return a(d.finallyLoc)}}}},abrupt:function(s,n){for(var a=this.tryEntries.length-1;a>=0;--a){var p=this.tryEntries[a];if(p.tryLoc<=this.prev&&u.call(p,"finallyLoc")&&this.prev<p.finallyLoc){var d=p;break}}d&&("break"===s||"continue"===s)&&d.tryLoc<=n&&n<=d.finallyLoc&&(d=null);var S=d?d.completion:{};return S.type=s,S.arg=n,d?(this.method="next",this.next=d.finallyLoc,$):this.complete(S)},complete:function(s,n){if("throw"===s.type)throw s.arg;return"break"===s.type||"continue"===s.type?this.next=s.arg:"return"===s.type?(this.rval=this.arg=s.arg,this.method="return",this.next="end"):"normal"===s.type&&n&&(this.next=n),$},finish:function(s){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.finallyLoc===s)return this.complete(a.completion,a.afterLoc),R(a),$}},catch:function(s){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc===s){var p=a.completion;if("throw"===p.type){var d=p.arg;R(a)}return d}}throw new Error("illegal catch attempt")},delegateYield:function(s,n,a){return this.delegate={iterator:Q(s),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=_),$}},i}(m.exports);try{regeneratorRuntime=v}catch(i){"object"==typeof globalThis?globalThis.regeneratorRuntime=v:Function("r","regeneratorRuntime = r")(v)}},5555:function(m,v,i){var f,u;f=function(){return function _(){var h=arguments.length;if(0===h)throw new Error("resolveUrl requires at least one argument; got none.");var g=document.createElement("base");if(g.href=arguments[0],1===h)return g.href;var y=document.getElementsByTagName("head")[0];y.insertBefore(g,y.firstChild);for(var x,w=document.createElement("a"),e=1;e<h;e++)w.href=arguments[e],g.href=x=w.href;return y.removeChild(g),x}},void 0!==(u=f.call(v,i,v,m))&&(m.exports=u)},8926:m=>{function v(f,u,_,h,g,y,w){try{var x=f[y](w),e=x.value}catch(U){return void _(U)}x.done?u(e):Promise.resolve(e).then(h,g)}m.exports=function i(f){return function(){var u=this,_=arguments;return new Promise(function(h,g){var y=f.apply(u,_);function w(e){v(y,h,g,w,x,"next",e)}function x(e){v(y,h,g,w,x,"throw",e)}w(void 0)})}},m.exports.__esModule=!0,m.exports.default=m.exports},3681:m=>{"use strict";m.exports=JSON.parse('{"name":"@ffmpeg/ffmpeg","version":"0.10.1","description":"FFmpeg WebAssembly version","main":"src/index.js","types":"src/index.d.ts","directories":{"example":"examples"},"scripts":{"start":"node scripts/server.js","build":"rimraf dist && webpack --config scripts/webpack.config.prod.js","prepublishOnly":"npm run build","lint":"eslint src","wait":"rimraf dist && wait-on http://localhost:3000/dist/ffmpeg.dev.js","test":"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:ffmpeg test:node:all","test:node":"node --experimental-wasm-threads --experimental-wasm-bulk-memory node_modules/.bin/_mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser":"mocha-headless-chrome -a allow-file-access-from-files -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:ffmpeg":"npm run test:browser -- -f ./tests/ffmpeg.test.html"},"browser":{"./src/node/index.js":"./src/browser/index.js"},"repository":{"type":"git","url":"git+https://github.com/ffmpegwasm/ffmpeg.wasm.git"},"keywords":["ffmpeg","WebAssembly","video"],"author":"Jerome Wu <jeromewus@gmail.com>","license":"MIT","bugs":{"url":"https://github.com/ffmpegwasm/ffmpeg.wasm/issues"},"engines":{"node":">=12.16.1"},"homepage":"https://github.com/ffmpegwasm/ffmpeg.wasm#readme","dependencies":{"is-url":"^1.2.4","node-fetch":"^2.6.1","regenerator-runtime":"^0.13.7","resolve-url":"^0.2.1"},"devDependencies":{"@babel/core":"^7.12.3","@babel/preset-env":"^7.12.1","@ffmpeg/core":"^0.10.0","@types/emscripten":"^1.39.4","babel-loader":"^8.1.0","chai":"^4.2.0","cors":"^2.8.5","eslint":"^7.12.1","eslint-config-airbnb-base":"^14.1.0","eslint-plugin-import":"^2.22.1","express":"^4.17.1","mocha":"^8.2.1","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","wait-on":"^5.3.0","webpack":"^5.3.2","webpack-cli":"^4.1.0","webpack-dev-middleware":"^4.0.0"}}')}}]);